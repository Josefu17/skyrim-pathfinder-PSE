# Database Migrations (Local Development)

## Prerequisites

Ensure the following before proceeding with database migrations:

1. **Local Database**: Your local database should be up and running.
2. **Environment Variables**: Expose the following environment variables on your system:
   - `DB_NAME` = `<your-local-db-name>`
   - `DB_USER` = `<your-local-db-user>`
   - `DB_PASSWORD` = `<your-local-db-password>`
   - `DB_HOST` = `<your-local-db-host>`
   - `DB_PORT` = `<your-local-db-port>`

### Example Commands for Exposing Environment Variable

#### **Linux**
```bash
export DB_USER=postgres
export DB_PASSWORD=postgres
export DB_HOST=localhost
export DB_PORT=5432
export DB_DATABASE=postgres
```

#### **Windows (Command Prompt)**
```cmd
set DB_USER=postgres
set DB_PASSWORD=postgres
set DB_HOST=localhost
set DB_PORT=5432
set DB_DATABASE=postgres
```

---

## Running Migrations with Alembic

Once your environment variables are set, follow these steps to detect changes in your models and create the necessary migration scripts.

### **Step 1: Autogenerate the Migration Script**
Run the following command in the same terminal where your `alembic.ini` file is located (usually in the project's root directory):

```bash
alembic revision --autogenerate -m "<your-migration-message-here>"
```

### **Step 2: Apply the Migration**
Apply the migration by upgrading to the latest version:

```bash
alembic upgrade head
```

---

## Important Notes

- **Push Migration Scripts**: Always push your migration scripts to the repository. Future migrations depend on the previous ones, so missing scripts can cause issues for others.
- **Review Autogenerated Scripts**: Even though Alembic can autogenerate scripts, always review them to ensure accuracy, especially for complex schema changes.
