stages:
  #- build
  - test
  - analyze

#build-job:
  # stage: build
  # image: ${CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX}/python:3.10-alpine  # Beispiel f√ºr ein Python-Projekt
  # services:
  #   - name: ${CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX}/python:3.10-alpine
  #     alias: python
  #   - name: ${CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX}/postgres:latest
  #     alias: postgres
  # script:
  #   - pip install --upgrade pip
  #   - python setup.py sdist bdist_wheel  # Erstelle das Paket
  #   - ls dist/
  # artifacts:
  #   paths:
  #     - build/  # Das Verzeichnis, das als Artefakt gespeichert wird

test-job:
  stage: test
  image: ${CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX}/python:3.13-alpine
  services:
    - name: postgres:latest
      alias: postgres
  variables:
    POSTGRES_USER: "pg-2"
    POSTGRES_PASSWORD: "pg-2"
    POSTGRES_DB: "navigation"
  before_script:
  - pip install -r requirements.txt
  script:
    - python -m pytest ./src/test*.py --verbose


analyze-job:
  stage: analyze
  image: ${CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX}/python:3.13-alpine
  before_script:
    - pip install -r requirements.txt
  script:
    - python -m pylint src/*.py
    - python -m black src/*.py
